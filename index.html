<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ShivanshCodex | Login</title>

<link rel="stylesheet" href="style.css">

<style>
/* ===== BASIC RESET ===== */
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family: "JetBrains Mono", monospace;
}

/* ===== BODY ===== */
body{
  background:#000;
  color:#00ff9c;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* ===== BACKGROUND (CLICK SAFE) ===== */
.bg{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
}

/* ===== CENTER BOX ===== */
.center-box{
  position:relative;
  z-index:5;
  border:2px solid #00ff9c;
  padding:25px;
  width:90%;
  max-width:360px;
  text-align:center;
}

/* ===== TITLE ===== */
.center-box h1{
  margin-bottom:20px;
  letter-spacing:2px;
}

/* ===== INPUT ===== */
.center-box input{
  width:100%;
  padding:12px;
  margin:10px 0;
  background:#eaf2ff;
  border:none;
  outline:none;
  font-size:15px;
}

/* ===== BUTTON ===== */
.center-box button{
  width:100%;
  padding:14px;
  margin-top:12px;
  background:transparent;
  border:2px solid #00ff9c;
  color:#00ff9c;
  font-size:15px;
  letter-spacing:3px;
  cursor:pointer;
}

.center-box button.login{
  background:#00ff9c;
  color:#000;
}
</style>
</head>

<body>

<div class="bg"></div>

<div class="center-box">
  <h1>ShivanshCodex</h1>

  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">

  <button type="button" onclick="signup()">SIGN UP</button>
  <button type="button" class="login" onclick="login()">LOGIN</button>
</div>

<!-- ================= JS ================= -->
<script type="module">

/* ===== IMPORT FIREBASE ===== */
import { db } from "./firebase.js";
import { ref, set, get } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js";

/* ===== SIGN UP ===== */
window.signup = function(){
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  if(!email || !password){
    alert("Email aur password daal bhai");
    return;
  }

  const userId = email.replace(/[@.]/g,"_");

  set(ref(db,"users/"+userId),{
    email:email,
    password:password
  }).then(()=>{
    alert("Signup successful ‚úÖ");
  }).catch(err=>{
    alert(err.message);
  });
}

/* ===== LOGIN ===== */
window.login = function(){
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  const userId = email.replace(/[@.]/g,"_");

  get(ref(db,"users/"+userId)).then(snapshot=>{
    if(snapshot.exists()){
      if(snapshot.val().password === password){
        alert("Login successful üî•");
        window.location.href = "chat.html";
      }else{
        alert("Password galat hai ‚ùå");
      }
    }else{
      alert("User nahi mila ‚ùå");
    }
  });
}

</script>

</body>
</html>
